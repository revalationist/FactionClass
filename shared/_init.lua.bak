class("Faction")

function Faction:__init(args)
  self.Morale = 0
  self.Balance = 0
  self.Members = {}
  self.Name = args
  
  if IsValid(LocalPlayer) then
    self.Execution = "client"
    print("LocalPlayer is valid, running on client")
  else
    self.Execution = "server"
    print("LocalPlayer is invalid, running on server")
  end
end

function Faction:GetName()
  return self.name
end

function Faction:SetName(new)
  
  local eArgs = {}
  eArgs.faction = self
  eArgs.old = self.name
  eArgs.new = new
  eArgs.execution = self.Execution
  
  Events:Fire("FactionNameChanged", eArgs)
  self.name = new
end


function Faction:GetMorale()
  return self.Morale
end

function Faction:SetMorale(new)
  
  
  local eArgs = {}
  eArgs.faction = self
  eArgs.old = self.Morale
  eArgs.new = new
  eArgs.execution = self.Execution
  
  self.Morale = new
  
  Events:Fire("FactionMoraleChanged", eArgs)
end

function Faction:GetBalance()
  return self.Balance
end

function Faction:SetBalance(new)
  
  local eArgs = {}
  eArgs.faction = self
  eArgs.old = self.Balance
  eArgs.new = new
  eArgs.execution = self.Execution
  
  self.Balance = new
  Events:Fire("FactionBalanceChanged", eArgs)
end


function Faction:GetMembers()
  return self.Members
end

function Faction:GetMemberCount()
  return #self.Members
end

function Faction:AddMember(player)
  table.insert(self.Members, player)
    
  local eArgs = {}
  eArgs.faction = self
  eArgs.player = player
  eArgs.execution = self.Execution

  Events:Fire("PlayerAddedToFaction", eArgs)
end

function Faction:RemoveMember(player)
  local bool, index = self:IsMember(player)
  if bool and index > -1 then
    self.Members[index] = nil
    
    local eArgs = {}
    eArgs.faction = self
    eArgs.player = player
    eArgs.execution = self.Execution
    
    Events:Fire("PlayerRemovedFromFaction", eArgs)
  end
end

function Faction:IsMember(player)
  for index, value in pairs(self:GetMembers()) do
    if value == player then
      return true, index
    end
  end
  
  return false, -1
end

Roaches = Faction("Roaches")
Reapers = Faction("Reapers")
UlarBoys = Faction("Ular Boys")
Military = Faction("Panau Armed Forces")

function Player:GetFaction(self)
  return Faction:IsMember(self)
end